import json
import os
import random
import torch
import numpy as np

random.seed(43)

#file_paths = ['0571_nse_dnn_0.00_bicycle_10_n03792782_1418.png', '0545_nse_dnn_0.00_boat_10_n04612504_30617.png', '0793_nse_dnn_0.10_elephant_10_n02504458_2054.png', '0151_nse_dnn_0.10_cat_10_n02123045_3098.png', '0860_nse_dnn_0.90_bear_10_n02132136_4636.png', '0908_nse_dnn_0.60_chair_10_n02791124_5089.png', '0649_nse_dnn_0.60_airplane_10_n02690373_6665.png', '0598_nse_dnn_0.35_clock_10_n04548280_156.png', '0695_nse_dnn_0.90_boat_10_n03344393_771.png', '1125_nse_dnn_0.20_bottle_10_n03937543_2105.png', '0894_nse_dnn_0.35_keyboard_10_n03085013_20784.png', '1028_nse_dnn_0.00_clock_10_n04548280_4181.png', '0581_nse_dnn_0.90_keyboard_10_n04505470_3499.png', '1199_nse_dnn_0.60_oven_10_n04111531_10216.png', '0180_nse_dnn_0.20_oven_10_n04111531_4467.png', '0617_nse_dnn_0.05_clock_10_n03196217_3987.png', '0919_nse_dnn_0.20_bird_10_n02033041_17119.png', '0819_nse_dnn_0.00_bicycle_10_n03792782_13608.png', '0740_nse_dnn_0.35_dog_10_n02097474_10860.png', '0614_nse_dnn_0.00_cat_10_n02123394_1602.png', '0713_nse_dnn_0.03_bicycle_10_n02835271_6167.png', '0748_nse_dnn_0.05_dog_10_n02086646_4881.png', '1029_nse_dnn_0.03_bear_10_n02132136_6967.png', '1277_nse_dnn_0.10_dog_10_n02089867_4717.png', '1008_nse_dnn_0.60_car_10_n03100240_9875.png', '1084_nse_dnn_0.10_oven_10_n04111531_7965.png', '0924_nse_dnn_0.60_cat_10_n02125311_22037.png', '0166_nse_dnn_0.00_elephant_10_n02504013_1647.png', '1260_nse_dnn_0.10_bird_10_n02051845_3479.png', '0797_nse_dnn_0.00_boat_10_n03662601_31508.png', '0671_nse_dnn_0.20_bottle_10_n04557648_11992.png', '0410_nse_dnn_0.05_bear_10_n02132136_3224.png', '0863_nse_dnn_0.05_keyboard_10_n04505470_1043.png', '0988_nse_dnn_0.05_chair_10_n02791124_2470.png', '0148_nse_dnn_0.35_dog_10_n02094258_1224.png', '0926_nse_dnn_0.60_chair_10_n03376595_8995.png', '0080_nse_dnn_0.03_airplane_10_n02690373_3860.png', '0772_nse_dnn_0.35_truck_10_n04467665_47602.png', '0734_nse_dnn_0.20_knife_10_n03041632_7448.png', '1205_nse_dnn_0.60_elephant_10_n02504013_5996.png', '0723_nse_dnn_0.35_knife_10_n03041632_2153.png', '0517_nse_dnn_0.03_bird_10_n01860187_24935.png', '0981_nse_dnn_0.60_keyboard_10_n03085013_25066.png', '0590_nse_dnn_0.35_cat_10_n02123597_7615.png', '0725_nse_dnn_0.60_airplane_10_n02690373_3377.png', '0857_nse_dnn_0.20_bicycle_10_n03792782_11417.png', '1216_nse_dnn_0.03_chair_10_n02791124_5795.png', '0047_nse_dnn_0.90_chair_10_n02791124_5400.png', '0293_nse_dnn_0.03_bicycle_10_n03792782_6613.png', '0334_nse_dnn_0.90_boat_10_n02951358_30335.png', '0953_nse_dnn_0.03_bicycle_10_n02835271_3135.png', '0983_nse_dnn_0.10_knife_10_n03041632_11887.png', '1195_nse_dnn_0.03_truck_10_n03417042_11704.png', '0418_nse_dnn_0.00_boat_10_n02951358_7315.png', '0750_nse_dnn_0.03_truck_10_n03796401_6444.png', '0585_nse_dnn_0.90_bicycle_10_n03792782_4067.png', '0627_nse_dnn_0.10_bottle_10_n03983396_10251.png', '0462_nse_dnn_0.90_car_10_n04285008_15003.png', '0588_nse_dnn_0.90_knife_10_n03041632_4879.png', '1018_nse_dnn_0.03_clock_10_n04548280_6068.png', '1228_nse_dnn_0.20_knife_10_n03041632_44269.png', '0851_nse_dnn_0.05_clock_10_n03196217_3868.png', '0432_nse_dnn_0.35_bottle_10_n04557648_2954.png', '0779_nse_dnn_0.10_truck_10_n03417042_5380.png', '0249_nse_dnn_0.35_truck_10_n03417042_6847.png', '0948_nse_dnn_0.90_knife_10_n03041632_41493.png', '1093_nse_dnn_0.90_boat_10_n04273569_18898.png', '1191_nse_dnn_0.00_elephant_10_n02504458_291.png', '0434_nse_dnn_0.10_keyboard_10_n04505470_6876.png', '0205_nse_dnn_0.03_bottle_10_n04557648_12671.png', '0818_nse_dnn_0.05_keyboard_10_n03085013_24577.png', '0059_nse_dnn_0.05_oven_10_n04111531_16583.png', '0187_nse_dnn_0.05_dog_10_n02101388_2968.png', '0610_nse_dnn_0.05_knife_10_n03041632_99912.png', '0800_nse_dnn_0.20_bottle_10_n04560804_9981.png', '0083_nse_dnn_0.60_bear_10_n02133161_4882.png', '1135_nse_dnn_0.20_bottle_10_n02823428_7570.png', '0501_nse_dnn_0.20_boat_10_n03344393_11590.png', '0330_nse_dnn_0.90_cat_10_n02124075_9291.png', '0847_nse_dnn_0.00_bear_10_n02132136_25897.png', '0437_nse_dnn_0.00_car_10_n03100240_11400.png', '0008_nse_dnn_0.00_chair_10_n03376595_16202.png', '0592_nse_dnn_0.10_clock_10_n02708093_527.png', '1181_nse_dnn_0.05_dog_10_n02112350_5035.png', '0170_nse_dnn_0.05_car_10_n02814533_35054.png', '0651_nse_dnn_0.10_knife_10_n03041632_90407.png', '0596_nse_dnn_0.35_boat_10_n04273569_12536.png', '0044_nse_dnn_0.20_elephant_10_n02504013_2464.png', '1186_nse_dnn_0.10_bottle_10_n03983396_11859.png', '0272_nse_dnn_0.20_elephant_10_n02504013_8522.png', '0859_nse_dnn_0.90_bicycle_10_n03792782_30942.png', '0381_nse_dnn_0.60_bicycle_10_n03792782_15679.png', '1098_nse_dnn_0.60_car_10_n02814533_8232.png', '0624_nse_dnn_0.35_car_10_n02814533_81455.png', '0211_nse_dnn_0.03_truck_10_n04467665_67908.png', '0090_nse_dnn_0.35_bear_10_n02132136_2760.png']
#file_paths = ['0439_cop_dnn_c15_boat_10_n02951358_4972.png', '0457_cop_dnn_c15_airplane_10_n02690373_1933.png', '0221_cop_dnn_c10_cat_10_n02123159_6932.png', '0967_cop_dnn_c10_elephant_10_n02504013_4654.png', '0155_cop_dnn_c05_keyboard_10_n04505470_6080.png', '0778_cop_dnn_c03_bottle_10_n04560804_13157.png', '0277_cop_dnn_c03_chair_10_n02791124_5868.png', '0465_cop_dnn_c30_bird_10_n01796340_10024.png', '0502_cop_dnn_c05_elephant_10_n02504013_8347.png', '0353_cop_dnn_c01_chair_10_n04099969_4577.png', '0096_cop_dnn_c30_bear_10_n02132136_1338.png', '1051_cop_dnn_c15_keyboard_10_n04505470_6115.png', '0479_cop_dnn_c05_elephant_10_n02504458_6018.png', '0500_cop_dnn_c03_bird_10_n02017213_689.png', '0354_cop_dnn_c01_bicycle_10_n02835271_10283.png', '0534_cop_dnn_c100_chair_10_n04099969_28072.png', '1061_cop_dnn_c01_car_10_n02814533_89472.png', '0282_cop_dnn_c15_bicycle_10_n03792782_20193.png', '0417_cop_dnn_c30_keyboard_10_n04505470_4893.png', '0280_cop_dnn_c15_bicycle_10_n03792782_13002.png', '0106_cop_dnn_c50_boat_10_n03662601_12226.png', '1072_cop_dnn_c100_cat_10_n02123045_9583.png', '1263_cop_dnn_c50_bottle_10_n02823428_5288.png', '0190_cop_dnn_c10_bottle_10_n03937543_2494.png', '0215_cop_dnn_c03_cat_10_n02123597_11138.png', '0286_cop_dnn_c10_bear_10_n02132136_8975.png', '0363_cop_dnn_c03_bear_10_n02134084_169.png', '1090_cop_dnn_c15_truck_10_n03796401_20373.png', '0954_cop_dnn_c10_bicycle_10_n02835271_12764.png', '1037_cop_dnn_c15_dog_10_n02108000_4202.png', '0850_cop_dnn_c01_cat_10_n02123394_7700.png', '0584_cop_dnn_c100_clock_10_n03196217_8618.png', '0461_cop_dnn_c100_chair_10_n03376595_11049.png', '1063_cop_dnn_c100_cat_10_n02123597_16831.png', '0856_cop_dnn_c30_bicycle_10_n03792782_20190.png', '0743_cop_dnn_c03_bird_10_n01855672_14214.png', '0841_cop_dnn_c50_boat_10_n03344393_629.png', '0477_cop_dnn_c30_dog_10_n02101388_8775.png', '1235_cop_dnn_c01_bird_10_n01592084_9625.png', '0797_cop_dnn_c03_clock_10_n04548280_4286.png', '0862_cop_dnn_c30_clock_10_n02708093_4976.png', '0823_cop_dnn_c50_cat_10_n02123597_13272.png', '0607_cop_dnn_c03_boat_10_n03662601_18803.png', '1083_cop_dnn_c30_cat_10_n02123045_11032.png', '0812_cop_dnn_c03_elephant_10_n02504013_3028.png', '0921_cop_dnn_c01_clock_10_n04548280_2343.png', '0122_cop_dnn_c50_bird_10_n01829413_14594.png', '0237_cop_dnn_c05_bottle_10_n04591713_4019.png', '1140_cop_dnn_c50_airplane_10_n02690373_911.png', '0269_cop_dnn_c05_boat_10_n03344393_7735.png', '0085_cop_dnn_c50_bicycle_10_n03792782_17571.png', '1165_cop_dnn_c10_bottle_10_n04557648_818.png', '0846_cop_dnn_c50_dog_10_n02113023_4391.png', '1247_cop_dnn_c15_clock_10_n03196217_2447.png', '0701_cop_dnn_c50_keyboard_10_n04505470_3117.png', '0815_cop_dnn_c05_elephant_10_n02504013_8162.png', '1170_cop_dnn_c10_knife_10_n03041632_24646.png', '0334_cop_dnn_c05_bird_10_n02037110_6736.png', '0878_cop_dnn_c05_bird_10_n02056570_13462.png', '0893_cop_dnn_c50_oven_10_n04111531_15852.png', '0213_cop_dnn_c01_oven_10_n04111531_22120.png', '0943_cop_dnn_c100_bird_10_n02027492_10246.png', '0753_cop_dnn_c30_knife_10_n03041632_4808.png', '0942_cop_dnn_c10_clock_10_n03196217_1814.png', '0682_cop_dnn_c30_car_10_n02814533_5183.png', '0290_cop_dnn_c05_bottle_10_n03983396_11137.png', '0834_cop_dnn_c05_cat_10_n02123597_13769.png', '1148_cop_dnn_c15_truck_10_n03417042_8654.png', '0678_cop_dnn_c10_oven_10_n04111531_14279.png', '0214_cop_dnn_c50_elephant_10_n02504458_5600.png', '0053_cop_dnn_c100_bottle_10_n02823428_6050.png', '0973_cop_dnn_c100_bottle_10_n04560804_23390.png', '1093_cop_dnn_c100_knife_10_n03041632_7279.png', '1159_cop_dnn_c100_clock_10_n04548280_1053.png', '0098_cop_dnn_c01_truck_10_n03796401_15046.png', '0252_cop_dnn_c03_keyboard_10_n03085013_22438.png', '0452_cop_dnn_c01_bear_10_n02133161_789.png', '1039_cop_dnn_c01_oven_10_n04111531_5102.png', '1059_cop_dnn_c05_truck_10_n03417042_708.png', '1272_cop_dnn_c15_boat_10_n03662601_6289.png', '0328_cop_dnn_c15_clock_10_n02708093_5429.png', '0124_cop_dnn_c15_boat_10_n03662601_1667.png', '0585_cop_dnn_c10_bottle_10_n03983396_4227.png', '0156_cop_dnn_c100_keyboard_10_n03085013_19065.png', '0068_cop_dnn_c100_knife_10_n03041632_50034.png', '0748_cop_dnn_c10_bear_10_n02133161_12045.png', '0453_cop_dnn_c30_chair_10_n04099969_9891.png', '0071_cop_dnn_c01_elephant_10_n02504013_3864.png', '0958_cop_dnn_c10_bird_10_n01820546_2924.png', '0572_cop_dnn_c01_truck_10_n04467665_22414.png', '0899_cop_dnn_c05_chair_10_n04099969_3686.png', '0016_cop_dnn_c03_airplane_10_n02690373_8743.png', '1074_cop_dnn_c03_bicycle_10_n02835271_7969.png', '0859_cop_dnn_c30_car_10_n03100240_10440.png', '0936_cop_dnn_c50_clock_10_n02708093_6835.png', '0842_cop_dnn_c30_boat_10_n03662601_3823.png']
file_paths = ['1045_hp_dnn_3_elephant_10_n02504013_6742.png', '0830_hp_dnn_3_oven_10_n04111531_4826.png', '0929_hp_dnn_1_chair_10_n04099969_1040.png', '1243_hp_dnn_1_oven_10_n04111531_4444.png', '0224_hp_dnn_0.4_boat_10_n03662601_2438.png', '0427_hp_dnn_0.7_elephant_10_n02504458_155.png', '0511_hp_dnn_0.7_car_10_n03100240_7703.png', '0411_hp_dnn_1.5_cat_10_n02123045_7154.png', '0190_hp_dnn_0.4_chair_10_n03376595_17747.png', '1062_hp_dnn_0.55_bottle_10_n03983396_1904.png', '0646_hp_dnn_1.5_dog_10_n02099601_2805.png', '0335_hp_dnn_3_airplane_10_n02690373_1053.png', '0194_hp_dnn_0.4_bear_10_n02134418_119.png', '0827_hp_dnn_0.7_keyboard_10_n04505470_4569.png', '0320_hp_dnn_0.55_keyboard_10_n03085013_23201.png', '0142_hp_dnn_0.45_clock_10_n04548280_8225.png', '1229_hp_dnn_0.55_dog_10_n02097298_6933.png', '1033_hp_dnn_3_bear_10_n02132136_15681.png', '0499_hp_dnn_1.5_knife_10_n03041632_55083.png', '1034_hp_dnn_3_clock_10_n04548280_5013.png', '0160_hp_dnn_inf_bird_10_n01797886_1953.png', '0357_hp_dnn_0.45_bird_10_n02018207_4151.png', '1164_hp_dnn_inf_knife_10_n03041632_22286.png', '0433_hp_dnn_1_bottle_10_n04579145_287.png', '0210_hp_dnn_0.7_car_10_n04285008_6320.png', '0867_hp_dnn_1_keyboard_10_n03085013_24115.png', '0532_hp_dnn_0.7_boat_10_n03344393_3219.png', '0330_hp_dnn_3_bottle_10_n04591713_4380.png', '0997_hp_dnn_1_bicycle_10_n02835271_6906.png', '0131_hp_dnn_3_truck_10_n03417042_212.png', '0247_hp_dnn_0.55_bear_10_n02134084_14031.png', '0657_hp_dnn_0.45_cat_10_n02123394_7335.png', '0627_hp_dnn_0.45_cat_10_n02125311_25104.png', '0100_hp_dnn_0.45_bird_10_n01530575_14402.png', '0113_hp_dnn_1.5_bird_10_n01616318_1214.png', '0750_hp_dnn_0.7_airplane_10_n02690373_8611.png', '0682_hp_dnn_inf_car_10_n02814533_40315.png', '0937_hp_dnn_1.5_clock_10_n04548280_5843.png', '0514_hp_dnn_0.55_bear_10_n02132136_23853.png', '0001_hp_dnn_0.7_boat_10_n03662601_12531.png', '0602_hp_dnn_1.5_truck_10_n04467665_45306.png', '0137_hp_dnn_inf_boat_10_n04612504_31305.png', '0474_hp_dnn_0.7_airplane_10_n02690373_194.png', '0234_hp_dnn_1.5_knife_10_n03041632_91967.png', '1042_hp_dnn_0.7_keyboard_10_n03085013_25800.png', '0977_hp_dnn_0.55_boat_10_n03344393_4349.png', '1109_hp_dnn_inf_car_10_n04285008_5838.png', '0179_hp_dnn_0.4_cat_10_n02123045_4812.png', '0543_hp_dnn_inf_boat_10_n02951358_31813.png', '1239_hp_dnn_0.4_keyboard_10_n03085013_19055.png', '1116_hp_dnn_inf_boat_10_n03662601_11276.png', '0261_hp_dnn_1_dog_10_n02091134_4525.png', '0826_hp_dnn_inf_boat_10_n03662601_4295.png', '0034_hp_dnn_3_bear_10_n02133161_1118.png', '0425_hp_dnn_inf_elephant_10_n02504458_150.png', '1015_hp_dnn_0.4_bird_10_n01829413_5849.png', '0428_hp_dnn_1_knife_10_n03041632_48062.png', '0127_hp_dnn_0.4_bear_10_n02133161_463.png', '0031_hp_dnn_0.4_chair_10_n04429376_10628.png', '0979_hp_dnn_inf_bear_10_n02133161_4580.png', '0764_hp_dnn_0.55_bottle_10_n03937543_4098.png', '0070_hp_dnn_0.45_keyboard_10_n03085013_22585.png', '0891_hp_dnn_1.5_car_10_n02814533_4501.png', '0147_hp_dnn_1_bird_10_n01824575_12784.png', '0962_hp_dnn_1.5_cat_10_n02125311_4034.png', '1028_hp_dnn_0.4_car_10_n03100240_8885.png', '0903_hp_dnn_0.4_clock_10_n02708093_3743.png', '0336_hp_dnn_3_airplane_10_n02690373_18848.png', '0580_hp_dnn_1_elephant_10_n02504013_6671.png', '0202_hp_dnn_inf_oven_10_n04111531_1723.png', '0219_hp_dnn_0.45_clock_10_n04548280_4345.png', '0462_hp_dnn_0.45_clock_10_n03196217_2003.png', '0925_hp_dnn_0.45_elephant_10_n02504458_6472.png', '1260_hp_dnn_0.45_bird_10_n01795545_3992.png', '0734_hp_dnn_0.55_car_10_n02814533_12532.png', '0560_hp_dnn_0.7_airplane_10_n02690373_10397.png', '0481_hp_dnn_0.55_car_10_n03100240_1794.png', '1086_hp_dnn_0.55_elephant_10_n02504013_1740.png', '0471_hp_dnn_0.4_truck_10_n04467665_70880.png', '0946_hp_dnn_3_bear_10_n02132136_17524.png', '0644_hp_dnn_3_dog_10_n02093256_2633.png', '1110_hp_dnn_3_bottle_10_n04591713_7374.png', '0138_hp_dnn_1_chair_10_n04099969_4275.png', '0296_hp_dnn_0.45_airplane_10_n02690373_5177.png', '0793_hp_dnn_0.45_oven_10_n04111531_4346.png', '0733_hp_dnn_1_clock_10_n04548280_4229.png', '0355_hp_dnn_1.5_airplane_10_n02690373_2316.png', '0015_hp_dnn_0.55_chair_10_n03376595_9524.png', '1090_hp_dnn_1_truck_10_n04467665_47602.png', '1056_hp_dnn_0.55_keyboard_10_n03085013_10035.png', '0360_hp_dnn_0.4_cat_10_n02123045_12748.png', '0128_hp_dnn_0.7_cat_10_n02123045_11126.png', '0817_hp_dnn_0.7_knife_10_n03041632_91582.png', '0300_hp_dnn_1.5_clock_10_n03196217_7918.png', '0393_hp_dnn_inf_boat_10_n02951358_3205.png', '1245_hp_dnn_1.5_elephant_10_n02504013_9257.png']
unique_filter = {}
class_results = {}
for i,fp in enumerate(file_paths):

    fp = fp.split('_')
    nl = fp[3]
    if nl in unique_filter:
        unique_filter[nl].append(i)
    else:
        unique_filter[nl] = [i]
        class_results[nl] = []
print(unique_filter)

data_folder = '/jobtmp/ggaonkar/diffusion-classifier/data/image16_high_pass/v2-0_1trials_50_10_1keep_50_100_500samples'

results = os.listdir(data_folder)

for f in results:
    index = int(f.split('.')[0])
    x = torch.load(os.path.join(data_folder, f))
    for key,value in unique_filter.items():
        if index in value:
            if x['pred']==x['label']:
                class_results[key].append(1)
            else:
                class_results[key].append(0)

for key, value in class_results.items():
    print(f'level {key} : {np.mean(value)}')
